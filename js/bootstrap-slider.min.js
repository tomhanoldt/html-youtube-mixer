/* =========================================================
 * bootstrap-slider.js v2.0.0
 * http://www.eyecon.ro/bootstrap-slider
 * =========================================================
 * Copyright 2012 Stefan Petre
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */
 !function(b){var e=function(a,c){this.element=b(a);this.picker=b('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle"></div><div class="slider-handle"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element);if(this.id=this.element.data("slider-id")||c.id)this.picker[0].id=this.id;"undefined"!==typeof Modernizr&&Modernizr.touch&&(this.touchCapable= !0);var d=this.element.data("slider-tooltip")||c.tooltip;this.tooltip=this.picker.find(".tooltip");this.tooltipInner=this.tooltip.find("div.tooltip-inner");this.orientation=this.element.data("slider-orientation")||c.orientation;switch(this.orientation){case "vertical":this.picker.addClass("slider-vertical");this.stylePos="top";this.mousePos="pageY";this.sizePos="offsetHeight";this.tooltip.addClass("right")[0].style.left="100%";break;default:this.picker.addClass("slider-horizontal").css("width",this.element.outerWidth()), this.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-14+"px"}this.min=this.element.data("slider-min")||c.min;this.max=this.element.data("slider-max")||c.max;this.step=this.element.data("slider-step")||c.step;this.value=this.element.data("slider-value")||c.value;this.value[1]&&(this.range=!0);this.selection=this.element.data("slider-selection")||c.selection;this.selectionEl=this.picker.find(".slider-selection"); "none"===this.selection&&this.selectionEl.addClass("hide");this.selectionElStyle=this.selectionEl[0].style;this.handle1=this.picker.find(".slider-handle:first");this.handle1Stype=this.handle1[0].style;this.handle2=this.picker.find(".slider-handle:last");this.handle2Stype=this.handle2[0].style;switch(this.element.data("slider-handle")||c.handle){case "round":this.handle1.addClass("round");this.handle2.addClass("round");break;case "triangle":this.handle1.addClass("triangle"),this.handle2.addClass("triangle")}this.range? (this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.handle2.addClass("hide"),this.value[1]="after"==this.selection?this.max:this.min);this.diff=this.max-this.min;this.percentage=[100*(this.value[0]-this.min)/this.diff,100*(this.value[1]-this.min)/this.diff,100*this.step/this.diff];this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos]; this.formater=c.formater;this.layout();if(this.touchCapable)this.picker.on({touchstart:b.proxy(this.mousedown,this)});else this.picker.on({mousedown:b.proxy(this.mousedown,this)});if("show"===d)this.picker.on({mouseenter:b.proxy(this.showTooltip,this),mouseleave:b.proxy(this.hideTooltip,this)});else this.tooltip.addClass("hide")};e.prototype={constructor:e,over:!1,inDrag:!1,showTooltip:function(){this.tooltip.addClass("in");this.over=!0},hideTooltip:function(){!1===this.inDrag&&this.tooltip.removeClass("in"); this.over=!1},layout:function(){this.handle1Stype[this.stylePos]=this.percentage[0]+"%";this.handle2Stype[this.stylePos]=this.percentage[1]+"%";"vertical"==this.orientation?(this.selectionElStyle.top=Math.min(this.percentage[0],this.percentage[1])+"%",this.selectionElStyle.height=Math.abs(this.percentage[0]-this.percentage[1])+"%"):(this.selectionElStyle.left=Math.min(this.percentage[0],this.percentage[1])+"%",this.selectionElStyle.width=Math.abs(this.percentage[0]-this.percentage[1])+"%");this.range? (this.tooltipInner.text(this.formater(this.value[0])+" : "+this.formater(this.value[1])),this.tooltip[0].style[this.stylePos]=this.size*(this.percentage[0]+(this.percentage[1]-this.percentage[0])/2)/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"):(this.tooltipInner.text(this.formater(this.value[0])),this.tooltip[0].style[this.stylePos]=this.size*this.percentage[0]/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/ 2)+"px")},mousedown:function(a){this.touchCapable&&"touchstart"===a.type&&(a=a.originalEvent);this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];a=this.getPercentage(a);if(this.range){var c=Math.abs(this.percentage[0]-a),d=Math.abs(this.percentage[1]-a);this.dragged=c<d?0:1}else this.dragged=0;this.percentage[this.dragged]=a;this.layout();if(this.touchCapable)b(document).on({touchmove:b.proxy(this.mousemove,this),touchend:b.proxy(this.mouseup,this)});else b(document).on({mousemove:b.proxy(this.mousemove, this),mouseup:b.proxy(this.mouseup,this)});this.inDrag=!0;a=this.calculateValue();this.element.trigger({type:"slideStart",value:a}).trigger({type:"slide",value:a});return!1},mousemove:function(a){this.touchCapable&&"touchmove"===a.type&&(a=a.originalEvent);a=this.getPercentage(a);this.range&&(0===this.dragged&&this.percentage[1]<a?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>a&&(this.percentage[1]=this.percentage[0],this.dragged=0));this.percentage[this.dragged]= a;this.layout();a=this.calculateValue();this.element.trigger({type:"slide",value:a}).data("value",a).prop("value",a);return!1},mouseup:function(a){this.touchCapable?b(document).off({touchmove:this.mousemove,touchend:this.mouseup}):b(document).off({mousemove:this.mousemove,mouseup:this.mouseup});this.inDrag=!1;!1==this.over&&this.hideTooltip();this.element;a=this.calculateValue();this.element.trigger({type:"slideStop",value:a}).data("value",a).prop("value",a);return!1},calculateValue:function(){var a; this.range?this.value=a=[this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,this.min+Math.round(this.diff*this.percentage[1]/100/this.step)*this.step]:(a=this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,this.value=[a,this.value[1]]);return a},getPercentage:function(a){this.touchCapable&&(a=a.touches[0]);a=100*(a[this.mousePos]-this.offset[this.stylePos])/this.size;a=Math.round(a/this.percentage[2])*this.percentage[2];return Math.max(0,Math.min(100,a))}, getValue:function(){return this.range?this.value:this.value[0]},setValue:function(a){this.value=a;this.range?(this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.handle2.addClass("hide"),this.value[1]="after"==this.selection?this.max:this.min);this.diff=this.max-this.min;this.percentage=[100*(this.value[0]-this.min)/this.diff,100*(this.value[1]-this.min)/ this.diff,100*this.step/this.diff];this.layout()}};b.fn.slider=function(a,c){return this.each(function(){var d=b(this),f=d.data("slider"),g="object"===typeof a&&a;f||d.data("slider",f=new e(this,b.extend({},b.fn.slider.defaults,g)));if("string"==typeof a)f[a](c)})};b.fn.slider.defaults={min:0,max:10,step:1,orientation:"horizontal",value:5,selection:"before",tooltip:"show",handle:"round",formater:function(a){return a}};b.fn.slider.Constructor=e}(window.jQuery);
